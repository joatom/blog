{"title":"Identifying Hotels","markdown":{"yaml":{"toc":false,"layout":"post","comments":{"utterances":{"repo":"joatom/blog"}},"date":"2021-05-28","description":"Some notes from a kaggle competition","categories":["Vision","ML","Competition"],"image":"logo_hotel.png","title":"Identifying Hotels","from":"markdown+emoji","author":"Johannes Tomasoni"},"headingText":"The challenge","containsRefs":false,"markdown":"\n\n> \"Recognizing a hotel from an image of a hotel room is important for human trafficking investigations. Images directly\nlink victims to places and can help verify where victims have\nbeen trafficked.\" (Stylianou et al., 2019). \n\nAs part of the [Eight Workshop on Fine-Grained Visual Categorization](https://sites.google.com/view/fgvc8/home) a kaggle competition was launched to support investigations by advancing models to identify hotels from images.\n\nThis post contains some parts of my contribution to the [Hotel-ID to Combat Human Trafficking 2021 - FGVC8](https://www.kaggle.com/c/hotel-id-2021-fgvc8/overview) kaggle competition.\n\nThe competition contained 97000+ images of hotel rooms from 7700**!** different hotels around the world. The objective was to identify the hotels of 13000 images from the hidden test set. The metric of the competition was Mean Average Precision of the top 5 picks (MAP@5). My solution scored **14th place** out of 92 teams with a 0.6164 MAP@5 on the private leaderboard.\n\nMy solution contained six CNN models with various configurations. More technical details and why I ended up with rather simple models is described in a kaggle [discussion topic](https://www.kaggle.com/c/hotel-id-2021-fgvc8/discussion/242030).\n\nHere I post the training and inference of one of the six models as well as the ensemble inference code.\n\n# Training\nThe final training was done on the entire train dataset. I didn't choose a cross validation strategy to safe training time. To keep variance low nonetheless I relied on the usual regularization strategies, such as dropout and augmentation and in particular on test time augmentation during inference.\n\nTo refine the model a validation set can be created by setting the `debug` flag as described in the notebook.\n<iframe src=\"https://www.kaggle.com/embed/joatom/hotel-train-fastai-densnet161?kernelSessionId=63702072\" height=\"800\" style=\"margin: 0 auto; width: 100%; max-width: 950px;\" frameborder=\"0\" scrolling=\"auto\" title=\"Hotel train (fastai + densnet161)\"></iframe>\n\n# Inference\n<iframe src=\"https://www.kaggle.com/embed/joatom/hotel-inference-fastai?kernelSessionId=63761117\" height=\"800\" style=\"margin: 0 auto; width: 100%; max-width: 950px;\" frameborder=\"0\" scrolling=\"auto\" title=\"Hotel inference (fastai)\"></iframe>\n\n# Inference ensemble\n<iframe src=\"https://www.kaggle.com/embed/joatom/fgvc8-hotel-ensemble-inference?kernelSessionId=63977973\" height=\"800\" style=\"margin: 0 auto; width: 100%; max-width: 950px;\" frameborder=\"0\" scrolling=\"auto\" title=\"fgvc8 - hotel ensemble (inference)\"></iframe>\n\n\n# References\n\nStylianou, Abby and Xuan, Hong and Shende, Maya and Brandt, Jonathan and Souvenir, Richard and Pless, Robert (2019). Hotels-50K: A Global Hotel Recognition Dataset. *The AAAI Conference on Artificial Intelligence (AAAI)*"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":true,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"markdown"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../../styles.css"],"toc":false,"from":"markdown+emoji","output-file":"index.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.2.256","bibliography":["../../references.bib"],"theme":{"light":"flatly","dark":"darkly"},"title-block-banner":true,"sidebar":false,"layout":"post","comments":{"utterances":{"repo":"joatom/blog"}},"date":"2021-05-28","description":"Some notes from a kaggle competition","categories":["Vision","ML","Competition"],"image":"logo_hotel.png","title":"Identifying Hotels","author":"Johannes Tomasoni"},"extensions":{"book":{"multiFile":true}}}}}
<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>AI curious</title>
<link>https://joatom.github.io/blog/snippets.html</link>
<atom:link href="https://joatom.github.io/blog/snippets.xml" rel="self" type="application/rss+xml"/>
<description>AI curios</description>
<generator>quarto-1.2.256</generator>
<lastBuildDate>Sun, 06 Nov 2022 23:00:00 GMT</lastBuildDate>
<item>
  <title>Partitioned Joins</title>
  <dc:creator>Johannes Tomasoni</dc:creator>
  <link>https://joatom.github.io/blog/snippets/2022-11-07-partitioned-join/index.html</link>
  <description><![CDATA[ 




<p>This query contains the harvest of three fruits over five days.</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb1-1"><span class="kw" style="color: #003B4F;">SELECT</span> f.name <span class="kw" style="color: #003B4F;">AS</span> fruit, </span>
<span id="cb1-2">       h.<span class="dt" style="color: #AD0000;">date</span>, </span>
<span id="cb1-3">       h.amount</span>
<span id="cb1-4">  <span class="kw" style="color: #003B4F;">FROM</span> fruit f,</span>
<span id="cb1-5">       harvest h</span>
<span id="cb1-6"> <span class="kw" style="color: #003B4F;">WHERE</span> h.fruit_id <span class="op" style="color: #5E5E5E;">=</span> f.fruit_id</span>
<span id="cb1-7"> <span class="kw" style="color: #003B4F;">ORDER</span> <span class="kw" style="color: #003B4F;">BY</span> <span class="dv" style="color: #AD0000;">1</span>, <span class="dv" style="color: #AD0000;">2</span>;</span></code></pre></div>
<table class="table">
<thead>
<tr class="header">
<th>FRUIT</th>
<th>DATE</th>
<th>AMOUNT</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Grape (red)</td>
<td>2022-09-01</td>
<td>5</td>
</tr>
<tr class="even">
<td>Grape (red)</td>
<td>2022-09-03</td>
<td>6</td>
</tr>
<tr class="odd">
<td>Grape (red)</td>
<td>2022-09-05</td>
<td>5</td>
</tr>
<tr class="even">
<td>Grape (white)</td>
<td>2022-09-01</td>
<td>6</td>
</tr>
<tr class="odd">
<td>Grape (white)</td>
<td>2022-09-03</td>
<td>4</td>
</tr>
<tr class="even">
<td>Grape (white)</td>
<td>2022-09-04</td>
<td>9</td>
</tr>
<tr class="odd">
<td>Grape (white)</td>
<td>2022-09-05</td>
<td>8</td>
</tr>
<tr class="even">
<td>Apple (red)</td>
<td>2022-09-01</td>
<td>4</td>
</tr>
<tr class="odd">
<td>Apple (red)</td>
<td>2022-09-04</td>
<td>2</td>
</tr>
<tr class="even">
<td>Apple (red)</td>
<td>2022-09-05</td>
<td>5</td>
</tr>
</tbody>
</table>
<p>A <strong>PARTITIONED OUTER JOIN</strong> can be used to includes the dates without harvest for each fruit:</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb2-1"><span class="kw" style="color: #003B4F;">WITH</span> baskets <span class="kw" style="color: #003B4F;">as</span> (</span>
<span id="cb2-2">  <span class="kw" style="color: #003B4F;">SELECT</span> f.name <span class="kw" style="color: #003B4F;">AS</span> fruit, </span>
<span id="cb2-3">         h.<span class="dt" style="color: #AD0000;">date</span>, </span>
<span id="cb2-4">         h.amount</span>
<span id="cb2-5">    <span class="kw" style="color: #003B4F;">FROM</span> fruit f,</span>
<span id="cb2-6">         harvest h</span>
<span id="cb2-7">  <span class="kw" style="color: #003B4F;">WHERE</span> h.fruit_id <span class="op" style="color: #5E5E5E;">=</span> f.fruit_id</span>
<span id="cb2-8">)</span>
<span id="cb2-9"><span class="kw" style="color: #003B4F;">SELECT</span> b.fruit,</span>
<span id="cb2-10">       t.<span class="dt" style="color: #AD0000;">date</span>,</span>
<span id="cb2-11">       <span class="fu" style="color: #4758AB;">nvl</span>(b.amount, <span class="dv" style="color: #AD0000;">0</span>) amount</span>
<span id="cb2-12">  <span class="kw" style="color: #003B4F;">FROM</span> baskets b</span>
<span id="cb2-13"><span class="kw" style="color: #003B4F;">PARTITION</span> <span class="kw" style="color: #003B4F;">BY</span> (b.fruit)</span>
<span id="cb2-14"> <span class="kw" style="color: #003B4F;">RIGHT</span> <span class="kw" style="color: #003B4F;">OUTER</span> <span class="kw" style="color: #003B4F;">JOIN</span> <span class="dt" style="color: #AD0000;">time</span> t</span>
<span id="cb2-15">    <span class="kw" style="color: #003B4F;">ON</span> (t.<span class="dt" style="color: #AD0000;">date</span> <span class="op" style="color: #5E5E5E;">=</span> b.<span class="dt" style="color: #AD0000;">date</span>)</span>
<span id="cb2-16"><span class="kw" style="color: #003B4F;">ORDER</span> <span class="kw" style="color: #003B4F;">BY</span> <span class="dv" style="color: #AD0000;">1</span>, <span class="dv" style="color: #AD0000;">2</span>;</span></code></pre></div>
<table class="table">
<thead>
<tr class="header">
<th>FRUIT</th>
<th>DATE</th>
<th>AMOUNT</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Grape (red)</td>
<td>2022-09-01</td>
<td>5</td>
</tr>
<tr class="even">
<td><strong>Grape (red)</strong></td>
<td><strong>2022-09-02</strong></td>
<td><strong>0</strong></td>
</tr>
<tr class="odd">
<td>Grape (red)</td>
<td>2022-09-03</td>
<td>6</td>
</tr>
<tr class="even">
<td><strong>Grape (red)</strong></td>
<td><strong>2022-09-04</strong></td>
<td><strong>0</strong></td>
</tr>
<tr class="odd">
<td>Grape (red)</td>
<td>2022-09-05</td>
<td>5</td>
</tr>
<tr class="even">
<td>Grape (white)</td>
<td>2022-09-01</td>
<td>6</td>
</tr>
<tr class="odd">
<td><strong>Grape (white)</strong></td>
<td><strong>2022-09-02</strong></td>
<td><strong>0</strong></td>
</tr>
<tr class="even">
<td>Grape (white)</td>
<td>2022-09-03</td>
<td>4</td>
</tr>
<tr class="odd">
<td>Grape (white)</td>
<td>2022-09-04</td>
<td>9</td>
</tr>
<tr class="even">
<td>Grape (white)</td>
<td>2022-09-05</td>
<td>8</td>
</tr>
<tr class="odd">
<td>Apple (red)</td>
<td>2022-09-01</td>
<td>4</td>
</tr>
<tr class="even">
<td><strong>Apple (red)</strong></td>
<td><strong>2022-09-02</strong></td>
<td><strong>0</strong></td>
</tr>
<tr class="odd">
<td><strong>Apple (red)</strong></td>
<td><strong>2022-09-03</strong></td>
<td><strong>0</strong></td>
</tr>
<tr class="even">
<td>Apple (red)</td>
<td>2022-09-04</td>
<td>2</td>
</tr>
<tr class="odd">
<td>Apple (red)</td>
<td>2022-09-05</td>
<td>5</td>
</tr>
</tbody>
</table>



 ]]></description>
  <category>SQL</category>
  <category>Oracle</category>
  <guid>https://joatom.github.io/blog/snippets/2022-11-07-partitioned-join/index.html</guid>
  <pubDate>Sun, 06 Nov 2022 23:00:00 GMT</pubDate>
</item>
</channel>
</rss>
